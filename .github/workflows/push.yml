name: æ¯æ—¥æ—©æ™šå®‰æ¨é€

on:
  schedule:
    # ğŸ•’ è®¾å®šä¸º UTC 23:30 (å³åŒ—äº¬æ—¶é—´ 07:30 å‘é€æ—©å®‰)
    - cron: '30 23 * * *'
    
    # ğŸ•’ è®¾å®šä¸º UTC 14:00 (å³åŒ—äº¬æ—¶é—´ 23:00 å‘é€æ™šå®‰)
    - cron: '0 15 * * *'
    
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨ç‚¹å‡»æµ‹è¯•

jobs:
  bot:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install requests

      - name: Run Push Script
        env:
          APP_ID: ${{ secrets.APP_ID }}
          APP_SECRET: ${{ secrets.APP_SECRET }}
          USER_ID: ${{ secrets.USER_ID }}
          TEMPLATE_MORNING: ${{ secrets.TEMPLATE_MORNING }}
          TEMPLATE_NIGHT: ${{ secrets.TEMPLATE_NIGHT }}
          WEATHER_KEY: ${{ secrets.WEATHER_KEY }}
          CITY_CODE: ${{ secrets.CITY_CODE }}
          LOVE_START_DATE: ${{ secrets.LOVE_START_DATE }}
          PET_START_DATE: ${{ secrets.PET_START_DATE }}
        run: |
          # è‡ªåŠ¨åˆ¤æ–­æ—¶é—´
          HOUR=$(date -u +%H)
          if [ $HOUR -lt 12 ]; then
            python main.py morning
          else
            python main.py night
          fi
